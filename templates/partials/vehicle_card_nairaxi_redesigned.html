{% comment %} templates/partials/vehicle_card_nairaxi_final.html {% endcomment %}
{% load static %}

<!--
  - The card itself. We've removed any fixed height. Its height will be determined by its content.
  - 'overflow-hidden' is crucial to ensure the rounded corners clip the image.
-->
<div class="group flex flex-col rounded-xl shadow-md hover:shadow-lg transition-all duration-300 bg-white overflow-hidden min-w-[280px] max-w-[320px]"
     data-aos="fade-up" 
     data-aos-delay="{{ forloop_counter0|default:0|add:'0'|stringformat:'s' }}00">
    
    <!-- === IMAGE CONTAINER (The Key to the Solution) === -->
    <a href="{{ vehicle.get_absolute_url }}" class="block relative w-full pt-[56.25%] bg-gray-100">
        {% if vehicle.main_image %}
            <img src="{{ vehicle.main_image.url }}" alt="{{ vehicle.vehicle_model }}" class="absolute top-0 left-0 w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
        {% else %}
            <img src="{% static 'images/vehicle_placeholder.png' %}" alt="Placeholder Vehicle Image" class="absolute top-0 left-0 w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
        {% endif %}
    </a>

    <!-- === TEXT CONTENT BLOCK === -->
    <div class="flex flex-col flex-grow p-5">
        <!-- This div grows to fill available space -->
        <div class="flex-grow">
            {% if vehicle.category %}
                <span class="inline-block bg-bg-subtle text-text-subtle text-xs font-semibold px-2.5 py-1 rounded-full mb-2">{{ vehicle.category.name }}</span> {# UPDATED: for consistency #}
            {% endif %}

            <a href="{{ vehicle.get_absolute_url }}" class="block">
                <h3 class="text-text-dark text-xl font-bold leading-tight truncate transition-colors group-hover:text-accent"> {# UPDATED #}
                    {{ vehicle.vehicle_model }} ({{ vehicle.year }})
                </h3>
            </a>

            <p class="text-text-subtle text-sm leading-relaxed mt-2 line-clamp-2"> {# UPDATED #}
                {{ vehicle.description|truncatewords:12 }}
            </p>
        </div>
        
        <!-- This div stays at the bottom -->
        <div class="mt-6 flex justify-between items-center">
            <p class="text-text-dark text-lg font-bold"> {# UPDATED #}
                â‚¦{{ vehicle.daily_rate_ngn|floatformat:"0" }}<span class="text-sm font-medium text-text-subtle">/day</span> {# UPDATED #}
            </p>
            
            <a href="{{ vehicle.get_absolute_url }}" class="bg-accent text-white text-center py-2 px-5 rounded-lg text-sm font-semibold hover:bg-accent-hover transition-all duration-300 transform hover:scale-105 active:scale-95"> {# UPDATED #}
                Lease Now
            </a>
        </div>
    </div>
</div>